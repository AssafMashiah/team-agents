# team-agents

A self-hosted [OpenClaw](https://docs.openclaw.ai/) setup for running multiple AI agents — deployable locally, on any Docker host, or via Cloudflare.

## What This Is

This repo is the single source of truth for your agent infrastructure:

- **OpenClaw gateway** — persistent Claude-powered agent runtime with Control UI
- **Ollama** — local LLM server (run Llama, Mistral, etc. entirely on your machine)
- **Discord + Signal** — messaging integrations so your agents are reachable anywhere
- **Cloudflare Tunnel** — secure remote access without opening firewall ports
- **Skills & Agents** — version-controlled, live-editable in local dev

---

## Quick Start

**Prerequisites:** [Docker Desktop](https://docs.docker.com/get-docker/) (includes Docker Compose v2)

```bash
# Clone the repo
git clone https://github.com/AssafMashiah/team-agents
cd team-agents

# First-time setup (creates .env, builds image, starts services, optionally pulls model)
bash scripts/setup.sh

# Open Control UI
open http://localhost:18789
```

Paste `OPENCLAW_GATEWAY_TOKEN` from `.env` into the Control UI to connect.

---

## Stack

| Service | Purpose | Port |
|---|---|---|
| `openclaw-gateway` | AI agent runtime + Control UI | 18789 |
| `openclaw-socat` | TCP bridge proxy | 18790 |
| `ollama` | Local LLM server | 11434 |
| `signal-bridge` | Signal bridge (optional) | 8080 |

---

## Directory Structure

```
team-agents/
├── skills/                       # Custom agent skills (live-mounted in local dev)
├── agents/                       # Agent persona configs (live-mounted in local dev)
├── scripts/
│   ├── setup.sh                  # First-time setup wizard
│   ├── update.sh                 # Pull latest + rebuild
│   ├── pull-model.sh             # Download an Ollama model
│   └── setup-signal.sh           # Register Signal phone number
├── cloudflare/
│   ├── wrangler.toml             # Cloudflare Tunnel config
│   └── CLOUDFLARE_SETUP.md      # Full deployment guide
├── Dockerfile                    # Custom image extending phioranex/openclaw-docker
├── docker-compose.yml            # Local dev stack
├── docker-compose.cloudflare.yml # Cloudflare / remote stack
├── .env.example                  # Template for all environment variables
└── .gitignore                    # Excludes .env and secrets
```

---

## Configuration

All secrets live in `.env` (git-ignored). See `.env.example` for every available option.

| Variable | Description |
|---|---|
| `ANTHROPIC_API_KEY` | Your Anthropic API key |
| `OPENCLAW_GATEWAY_TOKEN` | Auth token for Control UI (auto-generated by setup.sh) |
| `DISCORD_BOT_TOKEN` | Discord bot token |
| `SIGNAL_PHONE_NUMBER` | Phone number for Signal integration |
| `OLLAMA_DEFAULT_MODEL` | Local model (default: `llama3.1:8b`) |
| `CLOUDFLARE_TUNNEL_TOKEN` | Tunnel token for remote/CF deployment |

---

## Discord

1. Create a bot at [discord.com/developers](https://discord.com/developers/applications)
2. Grant: `Send Messages`, `Read Message History`, `View Channels`
3. Add `DISCORD_BOT_TOKEN` and `DISCORD_GUILD_ID` to `.env`
4. Optionally set `DISCORD_CHANNEL_ALLOWLIST` to restrict which channels the agent responds in

---

## Signal

```bash
# 1. Set SIGNAL_PHONE_NUMBER in .env
# 2. Start the bridge
docker compose --profile signal up -d
# 3. Register the number
bash scripts/setup-signal.sh
```

---

## Local LLM (Ollama)

```bash
# Pull the default model
bash scripts/pull-model.sh

# Or pick a specific model
bash scripts/pull-model.sh llama3.2:3b     # fast, ~2GB RAM
bash scripts/pull-model.sh llama3.1:8b     # balanced (recommended)
bash scripts/pull-model.sh llama3.3:70b    # powerful (40GB+ RAM)
bash scripts/pull-model.sh mistral:7b      # great for coding
```

OpenClaw connects to Ollama automatically via `http://ollama:11434` inside the Docker network.

---

## Cloudflare Deployment

See [cloudflare/CLOUDFLARE_SETUP.md](cloudflare/CLOUDFLARE_SETUP.md). The short version:

```bash
# Build + push your custom image to GHCR
docker build -t ghcr.io/assafmashiah/team-agents:latest .
docker push ghcr.io/assafmashiah/team-agents:latest

# Deploy with Cloudflare Tunnel
docker compose -f docker-compose.cloudflare.yml up -d
```

---

## Updating

```bash
bash scripts/update.sh
```

Pulls latest OpenClaw base image, rebuilds your custom image, restarts services.

---

## Adding Skills

See [skills/README.md](skills/README.md). Add a folder under `skills/` with a `SKILL.md` — changes are live immediately in local dev.

---

## Security

- `.env` is git-ignored — never commit it
- The Control UI requires the gateway token
- For remote deployments, protect the URL with Cloudflare Access
- The `workspace/` directory scopes what the agent can read/write
